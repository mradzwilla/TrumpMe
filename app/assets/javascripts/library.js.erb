$(document).ready(function(){

	var mainCanvas = document.getElementById('myCanvas');
    var context = mainCanvas.getContext('2d');
    var quotation = new Image();
    quotation.src = '/assets/quotationmark.png'


	function quoteTemplate1(){
		this.imageLink = "/assets/Trump1.jpg"
		this.quotation = 1
      	this.font = "38px Sans Serif";

		this.setText = function(input){
			this.text = "A lot of people ask me about " + input +". And let me tell you folks. It's bad. It's so bad. Nobody can believe how bad it is."
		}

		this.color = "#ffffff"

		this.wrapText = function(context, text) {
	        var words = text.split(' ');
	        var line = '';
	        var x = 90
	        var y = 68
	        var maxWidth = 320
	        var lineHeight = 40

	        for(var n = 0; n < words.length; n++) {
	          var testLine = line + words[n] + ' ';
	          var metrics = context.measureText(testLine);
	          var testWidth = metrics.width;
	          if (testWidth > maxWidth && n > 0) {
	            context.fillText(line, x, y);
	            line = words[n] + ' ';
	            y += lineHeight;
	          }
	          else {
	            line = testLine;
	          }
	        }
	        context.fillText(line, x, y);

	        var sigPosition = y + (2 * lineHeight)
	        context.fillText("Donald Trump", x, sigPosition)
	  	}	
	}

	function quoteTemplate2(){
		this.imageLink = "/assets/Trump3.jpeg",
		this.quotation = 1
      	this.font = "38px Sans Serif";

		this.setText = function(input){
			this.text = "People ask me what I'm going to do about " + input +". And I tell them I'm gonna win. Right now Obama is losing on " + input +". That's all he does is lose. Because he's a loser."
		}

		this.color = "#ffffff"

		this.wrapText = function(context, text) {
	        var words = text.split(' ');
	        var line = '';
	        var x = 90
	        var y = 68
	        var maxWidth = 650
	        var lineHeight = 40

	        for(var n = 0; n < words.length; n++) {
	          var testLine = line + words[n] + ' ';
	          var metrics = context.measureText(testLine);
	          var testWidth = metrics.width;
	          if (testWidth > maxWidth && n > 0) {
	            context.fillText(line, x, y);
	            line = words[n] + ' ';
	            y += lineHeight;
	            if (y >= 188){
	            	maxWidth = 320
	            }
	          }
	          else {
	            line = testLine;
	          }
	        }

	        context.fillText(line, x, y);

	        context.shadowColor = "#808080"
	        context.shadowOffsetX = 2;
	        context.shadowOffsetX = 2;
	        context.shadowBlur = 10

	        var sigPosition = y + (2 * lineHeight)
	        context.fillText("Donald Trump", x, sigPosition)

	        context.shadowColor = "#000000"
	  	}	
	}

	function quoteTemplate3(){
		this.imageLink = "/assets/Trump7.jpg"
		this.quotation = 0
		this.font = '31px Frutiger'
		this.color = "#292f33"

		this.setText = function(input){
			this.text = "Figures Crooked Hilary deleted all of her emails about " + input +"."
		}

		this.wrapText = function(context, text) {
	        var words = text.split(' ');
	        var line = '';
	        var x = 40
	        var y = 148
	        var maxWidth = 760
	        var lineHeight = 40

	        for(var n = 0; n < words.length; n++) {
	          var testLine = line + words[n] + ' ';
	          var metrics = context.measureText(testLine);
	          var testWidth = metrics.width;
	          if (testWidth > maxWidth && n > 0) {
	            context.fillText(line, x, y);
	            line = words[n] + ' ';
	            y += lineHeight;
	          }
	          else {
	            line = testLine;
	          }
	        }
	        context.fillText(line, x, y);
	  	}	
	}

    var quoteTemplate = new quoteTemplate2()

    var imageObj = new Image();
    imageObj.src = quoteTemplate.imageLink

    function createImage() {
      var text = $('#fname').val()

      context.drawImage(imageObj, 0, 0);
      
      if (quoteTemplate.quotation){context.drawImage(quotation, 19, 15)}; //quotationmark is 60 x 60

      context.font =  quoteTemplate.font;
      context.fillStyle = quoteTemplate.color

      quoteTemplate.setText(text)
      quoteTemplate.wrapText(context, quoteTemplate.text)

    };

	$('#submitButton').click(function(){
		createImage();
	})
})